

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>eutester.sshconnection &mdash; Eutester 0.0.4 documentation</title>
    
    <link rel="stylesheet" href="../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.0.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/theme_extras.js"></script>
    <link rel="top" title="Eutester 0.0.4 documentation" href="../../index.html" />
    <link rel="up" title="eutester" href="../eutester.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../../index.html">
          <span>Eutester 0.0.4 documentation</span></a></h1>
        <h2 class="heading"><span>eutester.sshconnection</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="../../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <h1>Source code for eutester.sshconnection</h1><div class="highlight"><pre>
<span class="c"># Software License Agreement (BSD License)</span>
<span class="c">#</span>
<span class="c"># Copyright (c) 2009-2011, Eucalyptus Systems, Inc.</span>
<span class="c"># All rights reserved.</span>
<span class="c">#</span>
<span class="c"># Redistribution and use of this software in source and binary forms, with or</span>
<span class="c"># without modification, are permitted provided that the following conditions</span>
<span class="c"># are met:</span>
<span class="c">#</span>
<span class="c">#   Redistributions of source code must retain the above</span>
<span class="c">#   copyright notice, this list of conditions and the</span>
<span class="c">#   following disclaimer.</span>
<span class="c">#</span>
<span class="c">#   Redistributions in binary form must reproduce the above</span>
<span class="c">#   copyright notice, this list of conditions and the</span>
<span class="c">#   following disclaimer in the documentation and/or other</span>
<span class="c">#   materials provided with the distribution.</span>
<span class="c">#</span>
<span class="c"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<span class="c"># ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE</span>
<span class="c"># LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<span class="c"># CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<span class="c"># SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
<span class="c"># INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
<span class="c"># CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<span class="c"># ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
<span class="c"># POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c">#</span>
<span class="c"># Author: matt.clark@eucalyptus.com</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Created on Mar 7, 2012</span>
<span class="sd">@author: clarkmatthew</span>

<span class="sd">simple class to establish an ssh session</span>
<span class="sd">example usage:</span>
<span class="sd">    import sshconnection</span>
<span class="sd">    ssh = SshConnection( &#39;192.168.1.1&#39;, keypath=&#39;/home/testuser/keyfile.pem&#39;)</span>
<span class="sd">    </span>
<span class="sd">    #use sys() to get either a list of output lines or a single string buffer depending on listformat flag</span>
<span class="sd">    output = ssh.sys(&#39;ls /dev/sd*&#39;,timeout=10)</span>
<span class="sd">    print output[0]</span>
<span class="sd">    print ssh.lastcmd+&quot; exited with code: &quot;+str(ssh.lastexitcode)</span>
<span class="sd">    </span>
<span class="sd">    #...or use cmd to get a dict of output, exitstatus, and elapsed time to execute...</span>
<span class="sd">    out = ssh.cmd(&#39;ping 192.168.1.2 -c 1 -W 5&#39;)</span>
<span class="sd">   </span>
<span class="sd">     print out[&#39;cmd&#39;]+&quot; exited with status:&quot;+out[&#39;status&#39;]+&quot;, elapsed time:&quot;+out[&#39;elapsed&#39;]</span>
<span class="sd">     print out[&#39;output&#39;]</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">paramiko</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">boto.ec2</span> <span class="kn">import</span> <span class="n">keypair</span>
<span class="kn">import</span> <span class="nn">select</span>

<div class="viewcode-block" id="SshCbReturn"><a class="viewcode-back" href="../../eutester.html#eutester.sshconnection.SshCbReturn">[docs]</a><span class="k">class</span> <span class="nc">SshCbReturn</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Used to return data from an ssh cmd callback method that can be used to handle output as it&#39;s rx&#39;d instead of...  </span>
<span class="sd">    waiting for the cmd to finish and returned buffer. See SshConnection.cmd() for more info.</span>
<span class="sd">    The call back must return type SshCbReturn.   </span>
<span class="sd">        If cb returns stop==True, recv loop will end, and channel will be closed, cmd will return. </span>
<span class="sd">        if cb settimer is &gt; 0, timer timeout will be adjusted for this time</span>
<span class="sd">        if cb statuscode is != -1 cmd status will return with this value</span>
<span class="sd">        if cb nextargs is set, the next time cb is called these args will be passed instead</span>
<span class="sd">        if cb buf is not None, the cmd[&#39;output&#39;] buffer will be appended with this buf</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">statuscode</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">settimer</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">nextargs</span><span class="o">=</span><span class="p">[]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">=</span> <span class="n">statuscode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settimer</span> <span class="o">=</span> <span class="n">settimer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nextargs</span> <span class="o">=</span> <span class="n">nextargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buf</span> <span class="o">=</span> <span class="n">buf</span>
</div>
<div class="viewcode-block" id="SshConnection"><a class="viewcode-back" href="../../eutester.html#eutester.sshconnection.SshConnection">[docs]</a><span class="k">class</span> <span class="nc">SshConnection</span><span class="p">():</span>
    <span class="n">cmd_timeout_err_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span>
    <span class="n">cmd_not_executed_code</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                 <span class="n">host</span><span class="p">,</span> 
                 <span class="n">keypair</span><span class="o">=</span> <span class="bp">None</span><span class="p">,</span> 
                 <span class="n">keypath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> 
                 <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> 
                 <span class="n">username</span><span class="o">=</span><span class="s">&#39;root&#39;</span><span class="p">,</span> 
                 <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> 
                 <span class="n">retry</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">debugmethod</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        host -mandatory - string, hostname or ip address to establish ssh connection to</span>
<span class="sd">        username - optional - string, username used to establish ssh session when keypath is not provided</span>
<span class="sd">        password - optional - string, password used to establish ssh session when keypath is not provided</span>
<span class="sd">        keypair - optional - boto keypair object, used to attept to derive local path to ssh key if present</span>
<span class="sd">        keypath  - optional - string, path to ssh key</span>
<span class="sd">        timeout - optional - integer, tcp timeout in seconds</span>
<span class="sd">        retry - optional - integer, # of attempts made to establish ssh session without auth failures</span>
<span class="sd">        debugmethod - method, used to handle debug msgs</span>
<span class="sd">        verbose - optional - boolean to flag debug output on or off</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keypair</span> <span class="o">=</span> <span class="n">keypair</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keypath</span> <span class="o">=</span> <span class="n">keypath</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="o">=</span><span class="n">username</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retry</span> <span class="o">=</span> <span class="n">retry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debugmethod</span> <span class="o">=</span> <span class="n">debugmethod</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        
        <span class="c">#Used to store the last cmd attempted and it&#39;s exit code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastcmd</span>  <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastexitcode</span> <span class="o">=</span> <span class="n">SshConnection</span><span class="o">.</span><span class="n">cmd_not_executed_code</span>
        
        
        
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keypair</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">keypath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">keypair</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot;.pem&quot;</span> 
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keypath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span> <span class="s">&quot;SSH connection has hostname:&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span> <span class="o">+</span><span class="s">&quot; user:&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">)</span> <span class="o">+</span><span class="s">&quot; and keypath: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keypath</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span> <span class="s">&quot;SSH connection has hostname:&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; user:&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">)</span> <span class="o">+</span><span class="s">&quot; password:&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">))</span>
            
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keypath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ssh_connection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">keypath</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypath</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Need either a keypath or username+password to create ssh connection&quot;</span><span class="p">)</span>
    
<div class="viewcode-block" id="SshConnection.debug"><a class="viewcode-back" href="../../eutester.html#eutester.sshconnection.SshConnection.debug">[docs]</a>    <span class="k">def</span> <span class="nf">debug</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        simple method for printing debug. </span>
<span class="sd">        msg - mandatory - string to be printed</span>
<span class="sd">        method - optional - callback to over ride default printing method </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">debugmethod</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
                <span class="k">print</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debugmethod</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SshConnection.ssh_sys_timeout"><a class="viewcode-back" href="../../eutester.html#eutester.sshconnection.SshConnection.ssh_sys_timeout">[docs]</a>    <span class="k">def</span> <span class="nf">ssh_sys_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chan</span><span class="p">,</span><span class="n">start</span><span class="p">,</span><span class="n">cmd</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        callback to be scheduled during ssh cmds which have timed out. </span>
<span class="sd">        chan - paramiko channel to be closed </span>
<span class="sd">        start - time.time() used to calc elapsed time when this fired for debug</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">chan</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">elapsed</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start</span>
        <span class="k">raise</span> <span class="n">CommandTimeoutException</span><span class="p">(</span><span class="s">&quot;SSH Command timer fired after &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">elapsed</span><span class="p">))</span><span class="o">+</span><span class="s">&quot; seconds. Cmd:&#39;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="o">+</span><span class="s">&quot;&#39;&quot;</span><span class="p">)</span>   
    
     </div>
<div class="viewcode-block" id="SshConnection.sys"><a class="viewcode-back" href="../../eutester.html#eutester.sshconnection.SshConnection.sys">[docs]</a>    <span class="k">def</span> <span class="nf">sys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">listformat</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Issue a command cmd and return output in list format</span>
<span class="sd">        cmd - mandatory - string representing the command to be run  against the remote ssh session</span>
<span class="sd">        verbose - optional - will default to global setting, can be set per cmd() as well here</span>
<span class="sd">        timeout - optional - integer used to timeout the overall cmd() operation in case of remote blockingd</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">listformat</span><span class="o">=</span><span class="n">listformat</span> <span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="s">&#39;output&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">code</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">out</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">code</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;Cmd:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="o">+</span><span class="s">&#39; failed with status code:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">output</span>
    
    </div>
<div class="viewcode-block" id="SshConnection.cmd"><a class="viewcode-back" href="../../eutester.html#eutester.sshconnection.SshConnection.cmd">[docs]</a>    <span class="k">def</span> <span class="nf">cmd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">readtimeout</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">listformat</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">cb</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cbargs</span><span class="o">=</span><span class="p">[]</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Runs a command &#39;cmd&#39; within an ssh connection. </span>
<span class="sd">        Upon success returns dict representing outcome of the command.</span>
<span class="sd">        Returns dict:</span>
<span class="sd">            [&#39;cmd&#39;] - The command which was executed</span>
<span class="sd">            [&#39;output&#39;] - The std out/err from the executed command</span>
<span class="sd">            [&#39;status&#39;] - The exit (exitcode) of the command, in the case a call back fires, this status code is unreliable.</span>
<span class="sd">            [&#39;cbfired&#39;]  - Boolean to indicate whether or not the provided callback fired (ie returned False)</span>
<span class="sd">            [&#39;elapsed&#39;] - Time elapsed waiting for command loop to end. </span>
<span class="sd">        Arguments:</span>
<span class="sd">        cmd - mandatory - string representing the command to be run  against the remote ssh session</span>
<span class="sd">        verbose - optional - will default to global setting, can be set per cmd() as well here</span>
<span class="sd">        timeout - optional - integer used to timeout the overall cmd() operation in case of remote blocking</span>
<span class="sd">        listformat - optional - boolean, if set returns output as list of lines, else a single buffer/string</span>
<span class="sd">        cb - optional - callback, method that can be used to handle output as it&#39;s rx&#39;d instead of...  </span>
<span class="sd">                        waiting for the cmd to finish and returned buffer. </span>
<span class="sd">                        Must accept string buffer, and return an integer to be used as cmd status. </span>
<span class="sd">                        Must return type &#39;sshconnection.SshCbReturn&#39;</span>
<span class="sd">                        If cb returns stop, recv loop will end, and channel will be closed.</span>
<span class="sd">                        if cb settimer is &gt; 0, timer timeout will be adjusted for this time</span>
<span class="sd">                        if cb statuscode is != -1 cmd status will return with this value</span>
<span class="sd">                        if cb nextargs is set, the next time cb is called these args will be passed instead</span>
<span class="sd">        cbargs - optional - list of arguments to be appended to output buffer and passed to cb</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args</span> <span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">verbose</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">cbfired</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastcmd</span> <span class="o">=</span> <span class="n">cmd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastexitcode</span> <span class="o">=</span> <span class="n">SshConnection</span><span class="o">.</span><span class="n">cmd_not_executed_code</span>
        <span class="n">t</span> <span class="o">=</span> <span class="bp">None</span> <span class="c">#used for timer </span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cbnextargs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">status</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span> <span class="s">&quot;[&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">+</span><span class="s">&quot;@&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;]# &quot;</span> <span class="o">+</span> <span class="n">cmd</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">tran</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">get_transport</span><span class="p">()</span>
            <span class="n">chan</span> <span class="o">=</span> <span class="n">tran</span><span class="o">.</span><span class="n">open_session</span><span class="p">()</span>
            <span class="n">chan</span><span class="o">.</span><span class="n">get_pty</span><span class="p">()</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">chan</span><span class="o">.</span><span class="n">makefile</span><span class="p">()</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">timeout</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssh_sys_timeout</span><span class="p">,[</span><span class="n">chan</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span><span class="n">cmd</span><span class="p">]</span> <span class="p">)</span>
            <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">chan</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span> 
            <span class="n">output</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="n">chan</span><span class="o">.</span><span class="n">fileno</span><span class="p">()</span>
            <span class="n">chan</span><span class="o">.</span><span class="n">setblocking</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">while</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">chan</span><span class="o">.</span><span class="n">closed</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">rl</span><span class="p">,</span> <span class="n">wl</span><span class="p">,</span> <span class="n">xl</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">fd</span><span class="p">],[],[],</span><span class="mf">0.0</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">select</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">while</span> <span class="n">chan</span><span class="o">.</span><span class="n">recv_ready</span><span class="p">():</span>
                        <span class="n">new</span> <span class="o">=</span> <span class="n">chan</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">new</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                            <span class="c">#We have data to handle...</span>
                            
                            <span class="c">#Run call back if there is one, let call back handle data read in</span>
                            <span class="k">if</span> <span class="n">cb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                                <span class="c">#If cb returns false break, end rx loop, return cmd outcome/output dict. </span>
                                <span class="n">cbreturn</span> <span class="o">=</span> <span class="n">SshCbReturn</span><span class="p">()</span>
                                <span class="n">cbreturn</span> <span class="o">=</span> <span class="n">cb</span><span class="p">(</span><span class="n">new</span><span class="p">,</span><span class="o">*</span><span class="n">cbargs</span><span class="p">)</span>
                                <span class="c">#Let the callback control whether or not to continue</span>
                                <span class="k">if</span> <span class="n">cbreturn</span><span class="o">.</span><span class="n">stop</span><span class="p">:</span>
                                    <span class="n">cbfired</span><span class="o">=</span><span class="bp">True</span>
                                    <span class="c">#Let the callback dictate the return code, otherwise -1 for connection err may occur</span>
                                    <span class="k">if</span> <span class="n">cbreturn</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                                        <span class="n">status</span> <span class="o">=</span> <span class="n">cbreturn</span><span class="o">.</span><span class="n">statuscode</span>
                                    <span class="k">else</span><span class="p">:</span>
                                        <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastexitcode</span> <span class="o">=</span> <span class="n">chan</span><span class="o">.</span><span class="n">recv_exit_status</span><span class="p">()</span>
                                    <span class="n">chan</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                                    <span class="k">break</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="c">#Let the callback update its calling args if needed</span>
                                    <span class="n">cbargs</span> <span class="o">=</span> <span class="n">cbreturn</span><span class="o">.</span><span class="n">nextargs</span> <span class="ow">or</span> <span class="n">cbargs</span>
                                    <span class="c">#Let the callback update/reset the timeout if needed</span>
                                    <span class="k">if</span> <span class="n">cbreturn</span><span class="o">.</span><span class="n">settimer</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> 
                                        <span class="n">t</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
                                        <span class="n">t</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">cbreturn</span><span class="o">.</span><span class="n">settimer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ssh_sys_timeout</span><span class="p">,[</span><span class="n">chan</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span><span class="n">cmd</span><span class="p">]</span> <span class="p">)</span>
                                        <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
                                    <span class="k">if</span> <span class="n">cbreturn</span><span class="o">.</span><span class="n">buf</span><span class="p">:</span>
                                        <span class="n">output</span> <span class="o">+=</span> <span class="n">cbreturn</span><span class="o">.</span><span class="n">buf</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c">#if no call back then append output to return dict and handle debug</span>
                                <span class="n">output</span> <span class="o">+=</span> <span class="n">new</span>
                                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                                    <span class="c">#Dont print line by line output if cb is used, let cb handle that </span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastexitcode</span> <span class="o">=</span> <span class="n">chan</span><span class="o">.</span><span class="n">recv_exit_status</span><span class="p">()</span>
                            <span class="n">chan</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                            <span class="n">t</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
                            <span class="k">break</span>
                
            <span class="k">if</span> <span class="p">(</span><span class="n">listformat</span><span class="p">):</span>
                <span class="c">#return output as list of lines</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">output</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c">#add command outcome in return dict. </span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">status</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastexitcode</span> <span class="o">=</span> <span class="n">chan</span><span class="o">.</span><span class="n">recv_exit_status</span><span class="p">()</span>
            <span class="n">ret</span><span class="p">[</span><span class="s">&#39;cmd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmd</span>
            <span class="n">ret</span><span class="p">[</span><span class="s">&#39;output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>
            <span class="n">ret</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">status</span>
            <span class="n">ret</span><span class="p">[</span><span class="s">&#39;cbfired&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cbfired</span>
            <span class="n">ret</span><span class="p">[</span><span class="s">&#39;elapsed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;done with exec&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">CommandTimeoutException</span><span class="p">,</span> <span class="n">cte</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">lastexitcode</span> <span class="o">=</span> <span class="n">SshConnection</span><span class="o">.</span><span class="n">cmd_timeout_err_code</span>
            <span class="n">elapsed</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Command (&quot;</span><span class="o">+</span><span class="n">cmd</span><span class="o">+</span><span class="s">&quot;) timeout exception after &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">elapsed</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot; seconds</span><span class="se">\n</span><span class="s">Exception&quot;</span><span class="p">)</span>     
            <span class="k">raise</span> <span class="n">cte</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">):</span>
                <span class="n">t</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>          
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">listformat</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
                
        <span class="k">return</span> <span class="n">ret</span>
        </div>
<div class="viewcode-block" id="SshConnection.refresh_connection"><a class="viewcode-back" href="../../eutester.html#eutester.sshconnection.SshConnection.refresh_connection">[docs]</a>    <span class="k">def</span> <span class="nf">refresh_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ssh_connection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">keypath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">retry</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="SshConnection.get_ssh_connection"><a class="viewcode-back" href="../../eutester.html#eutester.sshconnection.SshConnection.get_ssh_connection">[docs]</a>    <span class="k">def</span> <span class="nf">get_ssh_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s">&quot;root&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">keypath</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">retry</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create a paramiko ssh session to hostname. Will attempt to authenticate first with a keypath if provided, </span>
<span class="sd">        if the sshkey file path is not provided.  username and password will be used to authenticate. </span>
<span class="sd">        Upon success returns a paramiko sshclient with an established connection. </span>
<span class="sd">        hostname - mandatory - hostname or ip to establish ssh connection with</span>
<span class="sd">        username - optional - username used to authenticate ssh session</span>
<span class="sd">        password - optional - password used to authenticate ssh session</span>
<span class="sd">        keypath - optional - full path to sshkey file used to authenticate ssh session</span>
<span class="sd">        timeout - optional - tcp timeout </span>
<span class="sd">        retry - optional - amount of retry attempts to establish ssh connection for errors outside of authentication</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">password</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">keypath</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;ssh_connect: both password and keypath were set to None&quot;</span><span class="p">)</span>
        
        <span class="c">#self.debug(&quot;ssh_connect args:\nhostname:&quot;+hostname+&quot;\nusername:&quot;+username+&quot;\npassword:&quot;+str(password)+&quot;\nkeypath:&quot;+str(keypath)+&quot;\ntimeout:&quot;+str(timeout)+&quot;\nretry:&quot;+str(retry))</span>

        <span class="n">ssh</span> <span class="o">=</span> <span class="n">paramiko</span><span class="o">.</span><span class="n">SSHClient</span><span class="p">()</span>
        <span class="n">ssh</span><span class="o">.</span><span class="n">set_missing_host_key_policy</span><span class="p">(</span><span class="n">paramiko</span><span class="o">.</span><span class="n">AutoAddPolicy</span><span class="p">())</span>
    
        <span class="k">while</span> <span class="p">(</span> <span class="n">retry</span> <span class="o">&gt;=</span> <span class="mi">0</span>  <span class="p">):</span>
            <span class="n">retry</span> <span class="o">-=</span> <span class="mi">1</span> 
            <span class="k">try</span><span class="p">:</span>
                <span class="c">#self.debug(&quot;Attempting SSH connection: &quot;+username+&quot;@&quot;+hostname )            </span>
                <span class="k">if</span> <span class="n">keypath</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>   
                    <span class="c">#self.debug(&quot;Using username:&quot;+username+&quot; and password:&quot;+password)</span>
                    <span class="n">ssh</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">hostname</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span> <span class="n">timeout</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Using Keypath:&quot;</span><span class="o">+</span><span class="n">keypath</span><span class="p">)</span>
                    <span class="n">ssh</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">hostname</span><span class="p">,</span>  <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">key_filename</span><span class="o">=</span><span class="n">keypath</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span> <span class="n">timeout</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">paramiko</span><span class="o">.</span><span class="n">ssh_exception</span><span class="o">.</span><span class="n">SSHException</span><span class="p">,</span> <span class="n">se</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">retry</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Failed to connect to &quot;</span><span class="o">+</span><span class="n">hostname</span><span class="o">+</span><span class="s">&quot;, retry in 10 seconds&quot;</span><span class="p">)</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">se</span>
        <span class="c">#self.debug(&quot;Returning ssh connection to: &quot;+ hostname)</span>
        <span class="k">return</span> <span class="n">ssh</span>
    </div>
<div class="viewcode-block" id="SshConnection.close"><a class="viewcode-back" href="../../eutester.html#eutester.sshconnection.SshConnection.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>     
        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
        
        </div></div>
<div class="viewcode-block" id="CommandTimeoutException"><a class="viewcode-back" href="../../eutester.html#eutester.sshconnection.CommandTimeoutException">[docs]</a><span class="k">class</span> <span class="nc">CommandTimeoutException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">def</span> <span class="nf">__str__</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    

    
    
    
    </div>
</pre></div>

      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="../../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2012, Vic Iglesias, Matt Clark, Harold Spencer.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>